<!DOCTYPE html>
<html>
<head>
  <title>Recharge Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
      padding: 30px;
    }
    .card {
      background: #1e1e1e;
      padding: 20px;
      border-radius: 12px;
      max-width: 500px;
    }
    h2 { margin-top: 0; }
    .row { margin: 10px 0; }
    input {
      width: 100%;
      padding: 6px;
      margin-top: 4px;
      border-radius: 6px;
      border: none;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      background: #222;
      border-radius: 8px;
    }
    .big {
      font-size: 22px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="card">
  <h2>Recharge Dashboard</h2>

  <div class="row">
    Fixed Start Time:
    <div><strong>2026-02-17 17:40</strong></div>
  </div>

  <div class="row">
    Start Amount:
    <input type="number" id="startAmount" step="0.0001" value="0.6776">
  </div>

  <div class="row">
    Cycle (minutes):
    <input type="number" id="cycleMinutes" value="20">
  </div>

  <div class="row">
    Charge per Cycle:
    <input type="number" id="chargePerCycle" step="0.0001" value="0.0396">
  </div>

  <div class="result">
    <div>Current Amount: <span class="big" id="currentAmount">0.0000</span></div>
    <div>NFT Available: <span id="nftAvailable">0</span></div>
    <div>Cycles Completed: <span id="cyclesCompleted">0</span></div>
    <div>Next Target: <span id="nextTarget">1</span></div>
    <div>Time Until Next Target: <span id="timeRemaining">--</span></div>
  </div>
</div>

<script>
/* ===== FIXED START TIME HERE ===== */
const startTime = new Date("2026-02-17T17:40:00").getTime();
/* ================================== */

function update() {
  const now = Date.now();

  const startAmount = parseFloat(document.getElementById("startAmount").value);
  const cycleMinutes = parseFloat(document.getElementById("cycleMinutes").value);
  const chargePerCycle = parseFloat(document.getElementById("chargePerCycle").value);

  const cycleMs = cycleMinutes * 60 * 1000;

  if (now < startTime) {
    document.getElementById("currentAmount").textContent = startAmount.toFixed(4);
    document.getElementById("nftAvailable").textContent = Math.floor(startAmount);
    document.getElementById("cyclesCompleted").textContent = 0;
    document.getElementById("nextTarget").textContent = Math.floor(startAmount) + 1;
    document.getElementById("timeRemaining").textContent = "Not started";
    return;
  }

  const elapsed = now - startTime;
  const cyclesCompleted = Math.floor(elapsed / cycleMs);
  const currentAmount = startAmount + (cyclesCompleted * chargePerCycle);
  const nftAvailable = Math.floor(currentAmount);
  const nextTarget = nftAvailable + 1;

  // ===== CORRECT REMAINING CALCULATION =====

  const amountNeeded = nextTarget - currentAmount;
  const cyclesRemaining = Math.ceil(amountNeeded / chargePerCycle);

  const msIntoCurrentCycle = elapsed % cycleMs;
  const msUntilNextCycle = cycleMs - msIntoCurrentCycle;

  let totalRemainingMs;

  if (cyclesRemaining <= 1) {
    totalRemainingMs = msUntilNextCycle;
  } else {
    totalRemainingMs =
      msUntilNextCycle + ((cyclesRemaining - 1) * cycleMs);
  }

  let timeRemaining = "Ready";

  if (totalRemainingMs > 0) {
    const hours = Math.floor(totalRemainingMs / (1000 * 60 * 60));
    const minutes = Math.floor((totalRemainingMs % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((totalRemainingMs % (1000 * 60)) / 1000);
    timeRemaining = `${hours}h ${minutes}m ${seconds}s`;
  }

  document.getElementById("currentAmount").textContent =
    currentAmount.toFixed(4);
  document.getElementById("nftAvailable").textContent = nftAvailable;
  document.getElementById("cyclesCompleted").textContent = cyclesCompleted;
  document.getElementById("nextTarget").textContent = nextTarget;
  document.getElementById("timeRemaining").textContent = timeRemaining;
}


setInterval(update, 1000);
</script>

</body>
</html>
